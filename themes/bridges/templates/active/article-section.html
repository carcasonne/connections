{% extends "base.html" %}

{% block title %}{{ section.title }}{% endblock title %}

{% block extra_head %}
<link rel="stylesheet" href="/css/page.css">
<link rel="stylesheet" href="/css/section.css">
<link rel="stylesheet" href="/css/lain-theme.css">
<link rel="stylesheet" href="/css/page-specific/book-section.css">
<link rel="stylesheet" href="/css/page-specific/article-section.css">
{% endblock extra_head %}

{% block content %}
<section id="section-overview" class="section">
    <div class="section-header">
        <div class="section-content">
            <h1>{{ section.title }}</h1>
            <div class="layer-indicator">PROTOCOL://WIRED.RECORDS/{{ section.title | upper }}/INDEX</div>

            {% if section.content %}
            <div class="multi-column">
                {{ section.content | safe }}
            </div>
            {% endif %}
        </div>
    </div>

    {% if section.pages %}
    <!-- Article Navigation/Index -->
    <div class="article-index">
        <div class="index-header">
            <h2>Article Index</h2>
            <div class="index-count">{{ section.pages | length }} entries logged</div>
        </div>
        
        <div class="article-grid">
            {% for page in section.pages | sort(attribute="date") | reverse %}
            <div class="article-card">
                <div class="card-header">
                    <h3><a href="{{ page.permalink }}">{{ page.title }}</a></h3>
                    <div class="card-meta">
                        <span class="article-date">{{ page.date | date(format="%Y-%m-%d") }}</span>
                        {% if page.extra.connection_level %}
                        <span class="connection-level">{{ page.extra.connection_level }}</span>
                        {% endif %}
                    </div>
                </div>
                
                {% if page.summary %}
                <div class="article-summary">
                    {{ page.summary }}
                </div>
                {% else %}
                <div class="article-preview">
                    {{ page.content | striptags | truncate(length=200) }}
                </div>
                {% endif %}
                
                <div class="read-more">
                    <a href="{{ page.permalink }}">Read full article â†’</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="no-pages">
        <p>No entries found in this section.</p>
    </div>
    {% endif %}
</section>
{% endblock content %}