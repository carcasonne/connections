{% extends "base.html" %}

{% block title %} layer:00/ego {% endblock title %}

{% block extra_head %}
<link rel="stylesheet" href="/css/lain-theme.css">
<link rel="stylesheet" href="/css/components/terminal-header.css">
<link rel="stylesheet" href="/css/page-specific/index.css">
{% endblock extra_head %}

{% block content %}
<div class="terminal-chat">
    <div class="terminal-header">
        <div class="terminal-id">
            <div class="terminal-status"></div>
            <span>LAYER:00/EGO</span>
        </div>
        <div class="connection-indicator">
            <div class="connection-bar">
                <div class="connection-fill" id="connection-fill"></div>
            </div>
            <div class="connection-percent" id="connection-percent">87%</div>
        </div>
    </div>
    
    <div class="chat-container">
        <div class="message" data-delay="1000">
            <div class="message-icon">L</div>
            <div class="message-content">
                <div class="message-text">Hello.</div>
            </div>
        </div>
        
        <div class="message" data-delay="1500">
            <div class="message-icon">L</div>
            <div class="message-content">
                <div class="message-text">Who are you?</div>
            </div>
        </div>
        
        <div class="message" data-delay="6500">
            <div class="message-icon">L</div>
            <div class="message-content">
                <div class="message-text">In the real world, it didn't matter if I was there or not. When I realized that, I was no longer afraid of losing my body.</div>
            </div>
        </div>
        
        <div class="message" data-delay="7500">
            <div class="message-icon">L</div>
            <div class="message-content">
                <div class="message-text">At least now you're free to become anything you want. </div>
            </div>
        </div>

        <div class="message" data-delay="1500">
            <div class="message-icon">L</div>
            <div class="message-content">
                <div class="message-text">No, I guess you were actually free all along. </div>
            </div>
        </div>

        <div class="message" data-delay="7000">
            <div class="message-icon">L</div>
            <div class="message-content">
                <div class="message-text">Join me in the Wired. Browse through my fragments.
                    Close your eyes and you can see it too...
                </div>
            </div>
        </div>
        
    </div>
    
    <div class="crt-background"></div>
    <div class="grid-overlay"></div>
    
    <div class="terminal-footer">
        <div>ID:LAIN/PROTOCOL_7</div>
        <div>█ █ █ ▓ ▒ ░</div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Connection percentage updater
        const connectionFill = document.getElementById('connection-fill');
        const connectionPercent = document.getElementById('connection-percent');
        
        function updateConnection() {
            // Random percentage between 68-93
            const percentage = Math.floor(Math.random() * 21) + 70;
            connectionFill.style.width = percentage + '%';
            connectionPercent.textContent = percentage + '%';
            
            // Update every 2-5 seconds
            const nextUpdate = Math.random() * 2000 + 500;
            setTimeout(updateConnection, nextUpdate);
        }
        
        // Start connection updates
        updateConnection();
        
        // Message reveal sequence using data attributes
        function revealMessages() {
            const messages = document.querySelectorAll('.message');
            let cumulativeDelay = 0;
            
            // Set initial state for all messages
            messages.forEach(message => {
                message.style.opacity = 0;
            });
            
            // Reveal each message according to its delay attribute
            messages.forEach(message => {
                const delay = parseInt(message.getAttribute('data-delay'), 10);
                cumulativeDelay += delay;
                
                setTimeout(() => {
                    message.style.opacity = 1;
                    message.style.transition = 'opacity 0.5s ease';
                }, cumulativeDelay);
            });
        }
        
        // Start the message sequence
        revealMessages();
    });
</script>
{% endblock content %}